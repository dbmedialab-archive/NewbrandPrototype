"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var get_xavier_id_1 = __importDefault(require("../get-xavier-id"));
describe('getXavierId', function () {
    it('is conistent', function () {
        var id = get_xavier_id_1.default();
        expect(get_xavier_id_1.default()).toBe(id);
    });
    it('is 36 characters long', function () {
        var id = get_xavier_id_1.default();
        expect(id.length).toBe(36);
    });
    it('gets id from generate function it has no cache or cookie', function () {
        var mockDocument = { cookie: '' };
        var noCache = true;
        var now = new Date();
        var generate = function () { return '5ae30848-5ccb-43be-b8ba-5336dc6038d7'; };
        var id = get_xavier_id_1.default(mockDocument, noCache, now, generate);
        expect(id).toBe('5ae30848-5ccb-43be-b8ba-5336dc6038d7');
    });
    it('sets cookie correctly', function () {
        var mockDocument = { cookie: '' };
        var noCache = true;
        var now = new Date(Date.UTC(2018, 10, 9, 8, 7, 6));
        var generate = function () { return '5ae30848-5ccb-43be-b8ba-5336dc6038d7'; };
        get_xavier_id_1.default(mockDocument, noCache, now, generate);
        expect(mockDocument).toEqual({
            cookie: 'xavier=5ae30848-5ccb-43be-b8ba-5336dc6038d7; Path=/; Expires=Sat, 09 Nov 2019 08:07:06 GMT; Secure; Domain=localhost',
        });
    });
    it('should return opt out id if it is set', function () {
        var mockDocument = { cookie: 'xavier_no=something;' };
        var noCache = true;
        var id = get_xavier_id_1.default(mockDocument, noCache);
        expect(id).toEqual('xavier_no');
    });
    it('should get the id from cookie', function () {
        var mockDocument = {
            cookie: 'xavier=f6f3ea48-f304-491e-b7e4-ebd13534ddd2; Path=/; Expires=Mon, 01 Des 2018 03:03:03 GMT; Secure;',
        };
        var noCache = true;
        var id = get_xavier_id_1.default(mockDocument, noCache);
        expect(id).toEqual('f6f3ea48-f304-491e-b7e4-ebd13534ddd2');
    });
    it('should return xavier_no despite having a xavierId stored in memory', function () {
        var mockDocument = { cookie: 'xavier_no=xavier_no;' };
        var noCache = false;
        var now = new Date(Date.UTC(2018, 10, 9, 8, 7, 6));
        var generate = function () { return '5ae30848-5ccb-43be-b8ba-5336dc6038d7'; };
        var xavierId = '5ae30848-5ccb-43be-b8ba-5336dc6038d7';
        var id = get_xavier_id_1.default(mockDocument, noCache, now, generate, xavierId);
        expect(id).toEqual('xavier_no');
    });
    it('should return xavierId stored in memory', function () {
        var mockDocument = { cookie: '' };
        var noCache = false;
        var now = new Date(Date.UTC(2018, 10, 9, 8, 7, 6));
        var generate = function () { return '3dc41921-4dba-29bd-b3bf-5452da6938d7'; };
        var xavierId = '5ae30848-5ccb-43be-b8ba-5336dc6038d7';
        var id = get_xavier_id_1.default(mockDocument, noCache, now, generate, xavierId);
        expect(id).toEqual('5ae30848-5ccb-43be-b8ba-5336dc6038d7');
    });
});
//# sourceMappingURL=get-xavier-id.test.js.map